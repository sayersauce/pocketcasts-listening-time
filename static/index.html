<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pocket Casts Listening Time</title>
</head>
<body>
    <h1>Pocket Casts Listening Time</h1>
    <button id="queryBtn">Query Latest</button>
    <div id="result"></div>

    <script>
        document.getElementById('queryBtn').onclick = async function() {
            const res = await fetch('http://localhost:8000/latest');
            const data = await res.json();
            if (data.seconds !== undefined) {
                const formatted = `${Math.floor(data.seconds/86400)}d ${Math.floor(data.seconds%86400/3600)}h ${Math.floor(data.seconds%3600/60)}m ${data.seconds%60}s`;
                document.getElementById('result').innerText = formatted;
            } else {
                document.getElementById('result').innerText = 'Error: ' + (data.error || 'Unknown error');
            }
        }
    </script>
</body>
</html>